\chapter[Классификация методов моделирования\\многофункциональных центров обслуживания]{Классификация методов моделирования\\многофункциональных центров\\обслуживания}
\section{Конечные автоматы}

Автомат можно представить как некоторое устройство (чёрный ящик), на которое подаются входные сигналы, снимаются выходные сигналы и которое может иметь определённые внутренние состояния. Они являются дискретно--детерминированными моделями (F – схема)~\cite{ak_det}.

Введём понятие алфавит, понимая под ним конечное множество объектов любой природы. В этом случае сами объекты можно называть буквами, ах конечную упорядоченную совокупность называют словом~\cite{ak_det}.

Конечный автомат имеет один вход и один выход. Он представляет собой объект, функционирующий в дискретные моменты времени. В каждый момент времени $t_i$ автомат находится в одном из возможных состояний $z(t_i)$. Начиная с нулевого момента времени на вход автомата поступает входной сигнал $х$, который является одной из букв входного алфавита $Х$.
Автомат следующим образом реагирует на поступление входных сигналов. Во--первых, состояние автомата изменяется в соответствии с одношаговой функцией переходов:
\begin{equation}
	\label{eq:ka_tr}
	z(t_i) = \varphi(z(t_{i-1}), x(t_i)).
\end{equation}
Во--вторых в каждый момент на выходе автомата появляется выходной сигнал $y(t_i)$, который является буквой выходного алфавита $Y$, и определяется функцией выходов:
\begin{equation}
	\label{eq:ka1_q}
	y(t_i) = \psi(z(t_{i-1}), x(t_i)).
\end{equation}

Таким образом конечный автомат можно определить как кортеж $A = (X, Y, Z, z_0, \varphi, \psi)$, где $X=\{x_1, ..., x_m\}$ --- множество входных сигналов (входной алфавит),  $Y=\{y_1, ..., y_n\}$ --- множество выходных сигналов (выходной алфавит), $Z=\{z_1, ..., z_f\}$ --- множество состояний (внутренний алфавит), $z_0$ --- начальное состояние, $\varphi$ -- функция переходов, которая некоторым парам <<состояние -- входной сигнал>> ставит в соответствие  новое состояние автомата, $\psi$ -- функция выходов, которая некоторым парам <<состояние -- входной сигнал>> ставит в соответствие выходные сигналы автомата.В общем случае конечный автомат может иметь много входов, состояний и выходов. В этом случае алфавиты представляют собой прямые произведения более простых алфавитов~\cite{ak_det}.

Смысл работы автомата состоит в том, что он реализует некоторое отображение множества слов входного алфавита $Х$ во множество слов выходного алфавита $Ү$. На уровне абстрактной теории понятие <<работа автомата>> понимается как преобразование входных слов в выходные. Можно сказать, что в данном случае мы отвлекаемся от внутренней структуры автомата и основное внимание уделяем поведению автомата относительно внешней среды~\cite{ak_det}. 

На практике наибольшее распространение получили автоматы Мили и Мура. Автомат Мили функционирует по формулам (\ref{eq:ka_tr}) и (\ref{eq:ka1_q}), то есть состояние и выходной сигнал зависят от входного сигнала и предыдущего состояния. Есть несколько способов задания автоматов. У автомата Мура функция переходов  (\ref{eq:ka_tr}), но функция выходов имеет вид $y(t_i) = \psi(z(t_{i-1}))$, то есть не зависит от входного сигнала. Автомат Мили --- более общий автомат, чем автомат Мура. У каждого конечного автомата Мура есть конечный автомат Мили его интерпретирующий~\cite{ak_types}.

В табличном виде автомат Мили задаётся двумя таблицами. Первая таблица описывает функцию перехода, в неё столбцы это состояния, а строки входные символы, а на пересечении находятся новые состояния. Вторая таблица аналогичным образом описывает функцию выходов. Для автомата Мура первая таблица такая же, а вторая состоит только из двух строк состоянии и выходов~\cite{ak_types}.

При решении задач моделирования часто более удобной формой является матричное задание конечного автомата. При этом можно рассматривать две матрицы --- матрицу переходов и матрицу выходов. Матрица переходов есть квадратная матрица, строки которой соответствуют исходным состояниям, а столбцы - состояниям перехода. Элементы на пересечении соответствует входному сигналу, вызывающему переход. Матрица выходов строится аналогично, но ее элемент соответствует выходному сигналу, выдаваемому при переходе. При матричном задании конечного автомата Мура матрица переходов аналогична соответствующей матрице автомата Мили, а выход описывается вектором выходов~\cite{ak_types}.

Ещё есть графический способ, при котором автомат представляется в виде направленного графа. Вершинами являются состояния, если из одного состояния можно перейти в другое, то они соединяются направленной дугой и ей присваивается метка. Эта метка содержит входной и выходной символ перехода. Граф автомата Мили изображён на рисунке \ref{img:miligr}~\cite{ak_types}.

\imgScale{0.7}{miligr}{Граф автомата Мили}
\FloatBarrier

Граф автомата Мура задаётся аналогично, только метка путь на содержит выходного символа. Он привязан к вершине. Граф автомата Мура изображён на рисунке \ref{img:murgr}~\cite{ak_types}.

\imgScale{0.7}{murgr}{Граф автомата Мили}
\FloatBarrier

По характеру отсчёта времени конечные автоматы делятся на синхронные и асинхронные. Автомат считается синхронным, когда моменты поступления входных сигналов, изменения состояний и выдачи выходных сигналов, определяются принудительно синхронизирующими сигналами (заранее определены). Реакция автомата на каждое значение входного сигнала заканчивается за один такт синхронизации. Асинхронные автоматы не имеют «жесткой» тактности. Они изменяют свои состояния при поступлении входных сигналов, которые могут появляться в произвольные моменты времени из некоторого интервала~\cite{ak_det}.

Конечные автоматы работают с дискретным временем и позволяют моделировать только детерминированные объекты. 

\section{Вероятностные автоматы}

Дискретно--стохастический подход (P --- схемы) использует в качестве математического аппарата вероятностные автоматы, которые можно определить, как дискретные потактные преобразователи информации с памятью, функционирование которых в каждом такте зависит только от состояния памяти в них и может быть описано статистически. Для такого автомата характерно задание таблицы вероятностей перехода автомата в некоторое состояние и появления некоторого выходного сигнала в зависимости от текущего состояния и входного сигнала~\cite{sheme_types}.

Конечный автомат рассматривался как детерминизированнный, то есть каждой паре состояния и входа однозначно сопоставлялись новое состояние и выход с помощью функций переходов и выходов. Вероятностный конечный автомат --- такой автомат, который вместо однозначного соответствия задаёт лишь условные вероятности появления некоторых пар новое состояние и выход, при условии реализаций некой пары состояния и входа~\cite{va}.

Кроме того, для вероятностного конечного автомата не задаётся однозначно начальное состояние, а задаётся лишь безусловные вероятности, с которыми каждое из состояний может оказаться начальным. Эти вероятности должны быть в промежутке от 0 до 1 и в сумме давать 1~\cite{va}. 

Описание функционирования вероятностного конечного автомата можно трактовать так, что для каждой пары значений состояния и входа задаётся совместное условное распределение вероятностей осуществления пар нового состояния и выхода. Сумма этих вероятностей должна быть равна единице для каждой пары состояния и входа~\cite{va}.

Если считать вероятности нового состояния и выхода независимо друг от друга, то этот автомат называется вероятностным автоматом Мили. Также подобно конечному автомату Мура возможен вероятностный конечный автомат, у которого выход не зависит от входа, а зависит только от текущего состояния~\cite{va}.

Вероятностный конечный автомат называется автономным, если все случайные законы распределения одинаковы при различных вариантах сочетания алфавитов входов~\cite{va}.

Вероятностные автоматы работают с дискретны как и конечны, но позволяют отражать стохастатическую природу объектов.

\section{Системы массового обслуживания}

Непрерывно--стохастический подход (Q --- схема) применяется для формализации процессов обслуживания.  Этот подход наиболее известен ввиду того, что большинство производственных, экономических, технических и т.д. систем по сути являются системами массового обслуживания. Под системой массового обслуживания понимают динамическую систему, предназначенную для эффективного обслуживания потока заявок  при ограничениях на ресурсы системы. В любой системе массового обслуживания можно выделить элементарный прибор, в котором уже выделяют накопитель заявок некоторой ёмкости, ожидающих обслуживания, канал обслуживания и потоки событий. Существуют поток заявок на обслуживание, характеризующийся моментами времени поступления и их атрибутами, и поток обслуживания, характеризующийся моментами начала и окончания обслуживания заявок. Под непрерывностью тут обозначается непрерывность времени. Моменты поступления заявки в систему и окончания обслуживания заявки --- случайны. Структура системы массового обслуживания приведена на рисунке \ref{img:smo}~\cite{sheme_types}.

\imgScale{0.7}{smo}{Стрктурная схема СМО}
\FloatBarrier

Основными задачами решаемые в рамках теории массового обслуживания являются: анализ, то есть определение количественных характеристик СМО при заданной структуре и заданных параметрах элементов, и синтез оптимальной структуры при заданных характеристиках и ограничениях на параметры элементов~\cite{ak_det}.

На вход СМО поступают заявки на обслуживание, образующие входящий поток. Они поступают из источником заявок. В зависимости от характера источника заявок различают разомкнутые и замкнутые СМО. В разомкнутых число заявок, вырабатываемых источником, считается неограниченным и поведение источника никак не связано с состоянием и=системы в любой момент времени. Для замкнутых СМО характерно конечное количество заявок, циркулирующих в системе. Обслуженные заявки возвращаются в источник и через некоторые момент времени могут попасть опять на вход~\cite{ak_det}.

По характеру обслуживания заявок все системы массового обслуживания делятся на три типа:
\begin{itemize}[label=---]
	\item системы с отказами;
	\item системы с ожиданием;
	\item системы смешанного типа.
\end{itemize}
СМО первого типа характеризуются тем, что поступившие в данный момент времени заявка тут же принимается к обслуживанию, если имеется хотя бы один свободный канал, или получает отказ, если все каналы заняты. В системах с ожиданием заявка в случае занятости всех каналов обслуживания становится в очередь и ожидает освобождения одного из них. Это наиболее представительный на практике класс систем. Системам смешанного типа присущи особенности двух вышеописанных систем. Заявка в такой системе становится в очередь, если в ожидании находится ограниченное число заявок. Этим числом может быть длинна очереди. Ограниченной также может быть и по длительность ожидания~\cite{smo}.

По дисциплине обслуживания заявок выделяют системы без приоритета и с приоритетом~\cite{smo}.

Ещё одним из признаков классификации является количество обслуживающих устройств или каналов: если система имеет один прибор или один канал, то она называется одноканальной, если же их более одного, то она называется многоканальной~\cite{smo_chan}. 

Важнейшей характеристикой СМО является входящий поток заявок. Число заявок в единицу времени, обычно называется интенсивностью и обознается $\lambda$. Если входящий поток является простейшим, поток распределён по закону Пуасона, то достаточно знать лишь $\lambda$ (или интервал поступление заявок $t_i = \frac{1}{\lambda}$). А интервала входящего на обслуживание потока $v_\lambda = 1$. В общем случает надо знать средннее значение $\lambda$ и $t_i$ и дисперсионную характеристику интервала входящего на обслуживание потока $v_\lambda$~\cite{smo}.

Система характеризуется числом каналов обслуживания $n$, длительностью обслуживания $t_p$ одной заявки и пропускной способностью $\mu$, число заявок, которое может обслужить поток в единицу времени. Отношение $\rho = \frac{\lambda}{\mu} = \frac{t_p}{t_i}$ называется коэффициентом использования пропускной способности или приведённой плотностью потока~\cite{smo}.

Многофункциональный центр обслуживания можно смоделировать используя, разомкнутую многоканальную СМО смешанного типа без приоритетов. Тогда рассмотрим $n$--канальную СМО с ожиданием, на которую поступает поток заявок с интенсивностью $\lambda$. Интенсивность обслуживания одного канала $m$. Число мест в очереди $m$. Тогда основные показатели работы СМО приведены ниже~\cite{smo}.

Вероятность того, что система находится в состоянии, в котором все каналы свободны обознается как $p_0$ и вычисляется по формуле
\begin{equation}
	\label{eq:smo_po}
	p_0 = (\sum_{i=0}^{n}\frac{\rho^i}{i!} + \frac{\rho^n+1(1-(\frac{\rho}{n})^m)}{n \cdot n! (1 - \frac{\rho}{n})})^{-1}.
\end{equation}
Среднее число заявок в очереди обознается как $L_q$ и вычисляется по формуле
\begin{equation}
	\label{eq:smo_lq}
	L_q=\frac{\rho^{n+1} p_0\left(1-\left(m+1-m \frac{\rho}{n}\right)\left(\frac{\rho}{n}\right)^m\right)}{n \cdot n !\left(1-\frac{\rho}{n}\right)^2}.
\end{equation}
Среднее число заявок под или средннее число занятых каналов обознается как $\bar{k}$ и вычисляется по формуле
\begin{equation}
	\label{eq:smo_k}
	\bar{k}=\rho\left(1-\frac{\rho^{n+m}}{n^m \cdot n !} p_0\right).
\end{equation}
Среднее число заявок в системе обознается как $L_s$ и вычисляется по формуле
\begin{equation}
	\label{eq:smo_ls}
	L_s=L_q+\bar{k}.
\end{equation}
Относительная пропускная способность обознается как $Q$ и вычисляется по формуле
\begin{equation}
	\label{eq:smo_q}
	Q=1-\frac{\rho^{n+m}}{n^m n !} p_0.
\end{equation}
Абсолютная пропускная способность системы обознается как $A$ и вычисляется по формуле
\begin{equation}
	\label{eq:smo_a}
	A=\lambda Q.
\end{equation}

Под системой массового обслуживания понимают динамическую систему, предназначенную для эффективного обслуживания потока заявок  при ограничениях на ресурсы системы. Она является непрерывно--стохастической моделью, где непрерывность подразумевает непрерывность времени. Позволяет моделировать случайные процессы. К данной модели сводится множество систем реального мира. В основном используется для исследования поведения заявок, находящихся в очереди, для получения услуги.

\section{Сети Петри}
Сетевой подход (N --- схема) используется для формализованного описания и анализа причинно--следственных связей в сложных системах, где одновременно протекает несколько процессов. Самым распространенным формализмом, описывающим структуру и взаимодействие параллельных систем и процессов, являются сети Петри.

Сеть Петри --- это математическая модель дискретных динамических систем, ориентированная на качественный анализ и синтез таких систем. Формально в терминах теории систем сеть Петри это кортеж $PN = (O,P,T,F,M_0)$, где $O=\{0,1,2,\ldots\}$ --- множество дискретных моментов времени; $P=\{p_1,p_2,\ldots\}$ --- непустое множество элементов сети, называемых позициями; $T=\{t_1,t_2,\ldots\}$ --- непустое множество элементов сети, называемых переходами; $F:(P \times T) \cup(T \times P) \rightarrow\{0,1,2, \ldots, k, \ldots\}$ --- функция инцидентности, где $k$ --- кратность дуги; $M_0$ --- начальная маркировка позиций. Множества позиций и переходов не пересекаются.

Функция инцидентности может быть представлена в виде $F = F^p \cup F^t$ и фактически задаёт два отображения $F^p(p,t) = P \times T \rightarrow\{0,1,2, \ldots\}$, т.е. для каждой позиции указываются связанные с ней переходы (с учетом их кратности); $F^t(t, p) = T \times P \rightarrow\{0,1,2, \ldots\}$, т.е. для каждого перехода указываются связанные с ним позиции (также с учетом кратности). 

Эти функции, в общем случае зависящие от времени, могут быть представлены матрицами инцидентности. Из вершины--позиции $p_i \in P$ дуга в вершину--переход $t_j \in T$ существует тогда и только тогда, когда элемент на пересечении $i$--ой строки и $j$--го столбца в матрице $f_{ij}^p > 0$. В этом случае говорят, что $t_i$ выходной переход позиции $p_i$. Аналогичным образом определяется выходная позиция перехода.

Каждая позиция $p_i \in P$ может содержав некоторый целочисленный ресурс $\mu(p) \ge 0$, называемый числом фишек внутри позиции. Вектор $M = [\mu_1, \mu_2, \ldots]$ называется маркировкой (разметкой) сети Петри. Каждая маркировка --- это отображение $M: P \rightarrow \{0,1,2,\ldots\}$. 

Сети Петри функционирует в дискретном времени и концентрируют внимание на локальных событиях (переходах), локальных условиях (позициях) и локальных связях в отличие от конечных автоматов. Это позволяет лучше моделировать асинхронные системы.

Смена маркировок (начиная с $M_0$) происходит в результате срабатывания переходов сети. Переход сети $t_j \in T$ может сработать при маркировке $M$, если для всех входных позиций $p_i \in P$ выполняется условие $\mu_i(p_i) - f_{ij}^p \ge 0$, т.е. если каждая входная позиция для данного перехода содержит столько же и ли больше чем кратность ведущей к переходу дуги. В результате срабатывания перехода в момент времени $\theta$ происходит смена маркировки по правилу: $\mu_i(\theta + 1) = \mu_i(\theta) - f_{ij}^p(\theta) -  f_{ji}^t(\theta)$. То есть переход изымает из каждой своей входной позиции число фишек, равное кратности входных дуг, и посылает в каждую свою выходную позицию число фишек, равное кратности выходных дуг. Если может сработать несколько переходов, то срабатывает один, любой из них. Функционирование сети останавливается, если при некоторой маркировке ни один из ее переходов не может сработать. В силу своей недетерминированности при одинаковой начальной разметке сети Петри могут порождать различные последовательности срабатывания ее переходов. Эти последовательности образуют слова в алфавите Т. Множество всевозможных слов, порождаемых сетью Петри, называют языком сети Петри. Две сети Петри эквивалентны, если порождают один и тот же язык.

Сети Петри также представимы в виде двудольного ориентированного мультиграфа. Этот граф содержит:
\begin{itemize}[label=---]
	\item позиции (места), обозначаемые кружками;
	\item переходы, обозначаемые планками;
	\item ориентированные дуги (стрелки), соединяющие позиции с переходами и переходы с позициями.
\end{itemize}
Благодаря наличию кратных дуг сеть Петри есть мультиграф. Благодаря двум типам вершин граф называется двудольным. Поскольку дуги имеют направление, граф является ориентированным. Пример такого графа изображён на рисунке \ref{img:petri}.

\imgScale{0.5}{petri}{Граф сети Петри}
\FloatBarrier